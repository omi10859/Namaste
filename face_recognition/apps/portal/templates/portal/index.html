{% extends '_base.html' %}

{% load static %}

{% block header_css %}
<style>
    body,
    html {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        overflow: hidden;
    }

    #faceDetector {
        position: relative;
    }

    .avatar {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        box-shadow: 0 0 5px #000;
        overflow: hidden;
    }

    #status_text,
    #video,
    #avatar {
        display: none;
        width: inherit;
        min-height: 100%;
    }

    #video {
        transform: scale(1.5);
    }

    #moodDetector,
    #train,
    #faceDetector {
        position: fixed;
        width: 100vw;
        height: 100vh;
        background-color: #1E8BC3;
        color: #FFF;
        top: 0;
        left: 0;
        z-index: 999999;
        display: none;
        animation: animatedBackground 20s linear infinite alternate-reverse;
    }

    @keyframes animatedBackground {
        0% {
            background-color: #6C7A89;
        }

        25% {
            background-color: #96281B;
        }

        50% {
            background-color: #22313F;
        }

        75% {
            background-color: #049372;
        }

        100% {
            background-color: #E67E22;
        }
    }

    #faceDetector {
        display: block;
    }

    .absolute-center {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        margin: auto;
    }

    #moodDetector .absolute-center,
    #train .absolute-center {
        width: 80%;
        height: 220px;
        text-align: center;
    }

    #faceDetector .absolute-center {
        width: 50%;
        height: 250px;
        text-align: center;
    }

    #moodDetector .mood-presenter,
    #train .mood-presenter {
        height: 4em;
    }

    #moodDetector .mood,
    #train .mood {
        font-size: 4em;
    }

    #moodDetector .mood-text,
    #train .mood-text {
        font-size: 3em;
    }

    .mood-button {
        font-size: 1em;
        margin-top: 10px;
        margin-bottom: 10px;
        background: transparent;
        border: 2px solid #FFF;
        border-radius: 10px;
        font-weight: bold;
        color: #FFF;
        transition: 0.5s all;
        cursor: pointer;
        padding: 5px 15px;
        display: none;
    }

    .mood-button:hover {
        background-color: rgba(255, 255, 255, 0.8);
        color: rgba(0, 0, 0, 0.7);
    }

    #track-container {
        display: none;
    }

    .track-link {
        color: #FFF;
        font-weight: 400;
    }

    .absolute-center {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        top: 0;
        margin: auto;
    }

    #main {
        /* background-color: rgba(46, 49, 49, 1); */
    }

    #jarvisHeadContainer {
        width: 100px;
        height: 100px;
        ;
    }

    #cameraPopup {
        background: #000;
        position: fixed;
        z-index: 99999;
    }
    #cameraInitialisePopup {
        background: #000;
        position: fixed;
        z-index: 9999;
    }

    /** Jarvis **/
    @import url(http://weloveiconfonts.com/api/?family=entypo);
    body {
        background: black;
    }
    #main {
        position: relative;
        z-index: 1;        
        color: #02feff;
        padding: 0px;
    }

    .core {
        background: #cedce0;
        width: 100px;
        height: 100px;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        border: 10px rgba(2, 255, 255, 0.15) solid;
        animation: flicker 0.2s infinite;
        margin-left: auto;
        margin-right: auto;
        margin-top: 40px;
    }

    .core2 {
        background: #cedce0;
        width: 100px;
        height: 100px;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        border: 10px rgba(2, 255, 255, 0.15) solid;
        animation: flicker2 0.2s infinite;
        margin-left: auto;
        margin-right: auto;
        margin-top: 40px;
    }

    .big_core {
        background: #cedce0;
        width: 200px;
        height: 200px;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        border: 10px rgba(2, 255, 255, 0.15) solid;
        animation: big_flicker 0.2s infinite;
    }

    .c_ease {
        animation: colour_ease 3s infinite ease-in-out;
    }

    .counterspin5 {
        animation: rotate_anti 5s linear infinite;
    }

    .counterspin4 {
        animation: rotate_anti 4s linear infinite;
    }

    .semi_arc {
        width: 100px;
        height: 100px;
        border: 6px solid #02feff;
        background: rgba(2, 254, 255, 0.2);
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        transform: rotateZ(0deg);
        transition: box-shadow 3s ease;
        text-align: center;
        line-height: 100px;
    }

    .semi_arc:hover {
        box-shadow: 0px 0px 30px rgba(2, 254, 255, 0.8);
        transition: 0.3s;
    }

    .semi_arc_2 {
        content: "";
        position: absolute;
        width: 94%;
        height: 94%;
        left: 3%;
        top: 3%;
        border: 5px solid #02feff;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        animation: rotate 4s linear infinite;
        text-align: center;
        line-height: 129px;
    }

    .semi_arc_2:after {
        content: "";
        position: absolute;
        width: 94%;
        height: 94%;
        left: 3%;
        top: 3%;
        border: 4px solid #02feff;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        animation: rotate_anti 2s linear infinite;
    }

    .semi_arc_3 {
        content: "";
        position: absolute;
        width: 94%;
        height: 94%;
        left: 3%;
        top: 3%;
        border: 5px solid #02feff;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        animation: rotate 4s linear infinite;
        text-align: center;
        line-height: 129px;
    }

    .arc {
        width: 100px;
        height: 100px;
        border: 6px solid #02feff;
        background: rgba(2, 254, 255, 0.2);
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        -moz-transform: rotateY(-30deg) translateZ(-200px);
        -ms-transform: rotateY(-30deg) translateZ(-200px);
        -webkit-transform: rotateY(-30deg) translateZ(-200px);
        transform: rotateY(-30deg) translateZ(-200px);
        transform: rotateZ(0deg);
        transition: box-shadow 3s ease;
        text-align: center;
        line-height: 100px;
    }

    .arc:hover {
        box-shadow: 0px 0px 30px rgba(2, 254, 255, 0.8);
        transition: 0.3s;
    }

    .arc:after {
        content: "";
        position: absolute;
        width: 94%;
        height: 94%;
        left: 3%;
        top: 3%;
        border: 4px solid #02feff;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        animation: rotate 4s linear infinite;
    }

    .e1:after {
        border-color: rgba(2, 255, 255, 0.6);
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
    }

    .e2:after {
        border-color: rgba(2, 255, 255, 0.6);
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-bottom: 5px solid transparent;
    }

    .e3 {
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        animation: rotate 5s linear infinite;
    }

    .e3:after {
        border-color: rgba(2, 255, 255, 0.6);
        border-top: 5px solid transparent;
        border-bottom: 5px solid transparent;
    }

    .e4 {
        width: 150px;
        height: 150px;
    }

    .e4_1 {
        border-color: rgba(2, 255, 255, 0.3);
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
    }

    .e4_1:after {
        border-color: rgba(2, 255, 255, 0.6);
        border-top: 4px solid transparent;
        border-bottom: 4px solid transparent;
    }

    .e5 {
        width: 200px;
        height: 200px;
    }

    .e5_1 {
        color: rgba(2, 255, 255, 0.15);
        border: 2px solid;
        border-left: 2px solid transparent;
        animation: rotate 5s linear infinite;
    }

    .e5_2 {
        color: rgba(2, 255, 255, 0.7);
        border: 4px solid;
        border-left: 4px solid transparent;
        border-right: 4px solid transparent;
        animation: rotate_anti 4s linear infinite;
    }

    .e5_3 {
        color: rgba(2, 255, 255, 0.5);
        border: 2px solid;
        border-left: 2px solid transparent;
        border-right: 2px solid transparent;
        animation: rotate 3s linear infinite;
    }

    .e5_4 {
        color: rgba(2, 255, 255, 0.15);
        border: 4px solid;
        border-left: 4px solid transparent;
        border-right: 4px solid transparent;
        border-bottom: 4px solid transparent;
        animation: rotate_anti 2s linear infinite;
    }

    .e6 {
        border-color: transparent;
        background: rgba(255, 255, 255, 0);
        width: 200px;
        height: 200px;
    }

    @keyframes rotate {
        0% {
            transform: rotateZ(0deg);
        }

        100% {
            transform: rotateZ(360deg);
        }
    }

    @keyframes rotate_anti {
        0% {
            transform: rotateZ(360deg);
        }

        100% {
            transform: rotateZ(0deg);
        }
    }

    @keyframes colour_ease {
        0% {
            border-color: #02feff;
        }

        50% {
            border-color: rgba(2, 254, 255, 0.5);
        }

        100% {
            border-color: #02feff;
        }
    }

    @keyframes flicker {
        0% {
            box-shadow: 0px 0px 16px 8px rgba(150, 255, 255, 0.5), inset 0px 1px 4px 2px rgba(21, 211, 233, 0.3);
        }

        40% {
            box-shadow: 0px 0px 16px 8px rgba(150, 255, 255, 0.5), inset 0px 1px 4px 2px rgba(21, 211, 233, 0.3);
        }

        50% {
            box-shadow: 0px 0px 16px 6px rgba(150, 255, 255, 0.5), inset 0px 1px 100px 2px rgba(21, 211, 233, 0.3);
        }

        60% {
            box-shadow: 0px 0px 16px 8px rgba(150, 255, 255, 0.5), inset 0px 1px 4px 2px rgba(21, 211, 233, 0.3);
        }

        100% {
            box-shadow: 0px 0px 16px 8px rgba(150, 255, 255, 0.5), inset 0px 1px 4px 2px rgba(21, 211, 233, 0.3);
        }
    }

    @keyframes flicker2 {
        0% {
            box-shadow: 0px 0px 60px 25px rgba(150, 255, 255, 0.5), inset 0px 1px 4px 2px rgba(21, 211, 233, 0.3);
        }

        40% {
            box-shadow: 0px 0px 60px 25px rgba(150, 255, 255, 0.5), inset 0px 1px 4px 2px rgba(21, 211, 233, 0.3);
        }

        50% {
            box-shadow: 0px 0px 50px 17px rgba(150, 255, 255, 0.5), inset 0px 1px 100px 2px rgba(21, 211, 233, 0.3);
        }

        60% {
            box-shadow: 0px 0px 60px 25px rgba(150, 255, 255, 0.5), inset 0px 1px 4px 2px rgba(21, 211, 233, 0.3);
        }

        100% {
            box-shadow: 0px 0px 60px 25px rgba(150, 255, 255, 0.5), inset 0px 1px 4px 2px rgba(21, 211, 233, 0.3);
        }
    }

    @keyframes big_flicker {
        0% {
            box-shadow: 0px 0px 40px 20px rgba(150, 255, 255, 0.5), inset 0px 1px 30px 15px rgba(21, 211, 233, 0.3);
        }

        40% {
            box-shadow: 0px 0px 40px 20px rgba(150, 255, 255, 0.5), inset 0px 1px 30px 15px rgba(21, 211, 233, 0.3);
        }

        50% {
            box-shadow: 0px 0px 35px 17px rgba(150, 255, 255, 0.5), inset 0px 1px 50px 40px rgba(21, 211, 233, 0.3);
        }

        60% {
            box-shadow: 0px 0px 40px 20px rgba(150, 255, 255, 0.5), inset 0px 1px 30px 15px rgba(21, 211, 233, 0.3);
        }

        100% {
            box-shadow: 0px 0px 40px 20px rgba(150, 255, 255, 0.5), inset 0px 1px 30px 15px rgba(21, 211, 233, 0.3);
        }
    }

    /* Font / Universal Properties */
    [class*="entypo-"]:before {
        font-family: 'entypo', sans-serif;
        transition: 0.3s;
    }

    * {
        user-select: none;
        font: 20px 'Agency FB', sans-serif;
    }

    html,
    body {
        height: 100%;
        overflow: hidden;
    }

    /* Left Menu */
    #leftmenu {
        position: fixed;
        float: left;
        margin-left: 50px;
        width: 210px;
    }

    #date_time {
        margin-left: 30px;
        width: 200px;
        height: 200px;
    }

    #time {
        margin-left: 110px;
        position: fixed;
        background: rgba(0, 0, 0, 0.8);
        line-height: 0;
    }

    #date {
        position: fixed;
        margin-top: 20px;
        background: rgba(0, 0, 0, 0.8);
    }

    .title {
        font-size: 30px;
        text-align: center;
        margin: 0;
        margin-top: 10px;
        margin-left: -15px;
    }

    .title_underline {
        border-color: rgba(2, 255, 255, 0.5);
    }

    .menu {
        width: 200px;
        height: 200px;
        margin: 0;
        padding: 5px;
    }

    .menuitem {
        width: 100%;
        height: 40px;
        padding: 5px;
        margin-left: 5px;
        color: #02feff;
        background: transparent;
        border: transparent;
        font-size: 15px;
        text-align: left;
        display: block;
        float: left;
        transition: 0.3s;
        cursor: pointer;
    }

    .caption {
        color: rgba(2, 255, 255, 0.6);
        display: inline;
        transition: 0.3s;
        cursor: pointer;
    }

    .caption:hover {
        color: #02feff;
    }

    .app_icon {
        width: 48px;
        color: rgba(2, 255, 255, 0.6);
        font-size: 40px;
        text-align: center;
        display: inline-block;
        cursor: pointer;
    }

    .app_icon:hover {
        color: #02feff;
    }

    /* Right Menu */
    #rightmenu {
        float: right;
        margin-right: 20px;
        width: 300px;
    }

    #note_input {
        color: rgba(2, 255, 255, 0.6);
        padding: 5px;
        border-style: none;
        background: transparent;
        resize: none;
        transition: 0.3s;
        width: calc(100% - 15px);
    }

    #note_input:hover {
        color: #02feff;
        transition: 0.3s;
    }

    /* Taskbar */
    #taskbar_wrapper #taskbar {
        position: fixed;
        width: 200px;
        height: 200px;
        background: gray;
        margin-left: auto;
        margin-right: auto;
    }

    /* Arc Reactor */
    ul {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    #arc_container {
        position: fixed;
        width: 100%;
        height: 100%;
        z-index: -1;
    }

    .arc_reactor {
        position: relative;
        top: 10%;
        /* margin-top: px; */
        margin-left: auto;
        margin-right: auto;
        width: 250px;
        height: 250px;
        border-radius: 50%;
        box-shadow: 0px 0px 50px 15px rgba(2, 255, 255, 0.3), inset 0px 0px 50px 15px rgba(2, 255, 255, 0.3);
    }

    .case_container {
        width: 210px;
        height: 210px;
        border-radius: 50%;
        position: absolute;
        margin-left: 20px;
        margin-top: 20px;
    }

    .core2 {
        background: #cedce0;
        width: 110px;
        height: 110px;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        border: 5px solid rgba(2, 255, 255, 0.15);
        animation: flicker2 0.2s infinite;
        margin-left: auto;
        margin-right: auto;
        margin-top: 40px;
    }

    .e7 {
        width: 95.25%;
        height: 95.25%;
        left: 2.5475%;
        right: 2.5475%;
        border: 6px solid transparent;
        background: transparent;
        -moz-border-radius: 50%;
        -webkit-border-radius: 50%;
        border-radius: 50%;
        transform: rotateZ(0deg);
        transition: box-shadow 3s ease;
        text-align: center;
        line-height: 100px;
    }

    .marks li {
        display: block;
        width: 3px;
        height: 11px;
        background: rgba(2, 254, 255, 0.8);
        position: absolute;
        margin-left: 105px;
        margin-top: -110px;
        animation: colour_ease2 3s infinite ease-in-out;
    }

    @keyframes colour_ease2 {
        0% {
            background: #02feff;
        }

        50% {
            background: rgba(2, 254, 255, 0.3);
        }

        100% {
            background: #02feff;
        }
    }

    .marks li:first-child {
        transform: rotate(6deg) translateY(125px);
    }

    .marks li:nth-child(2) {
        transform: rotate(12deg) translateY(125px);
    }

    .marks li:nth-child(3) {
        transform: rotate(18deg) translateY(125px);
    }

    .marks li:nth-child(4) {
        transform: rotate(24deg) translateY(125px);
    }

    .marks li:nth-child(5) {
        transform: rotate(30deg) translateY(125px);
    }

    .marks li:nth-child(6) {
        transform: rotate(36deg) translateY(125px);
    }

    .marks li:nth-child(7) {
        transform: rotate(42deg) translateY(125px);
    }

    .marks li:nth-child(8) {
        transform: rotate(48deg) translateY(125px);
    }

    .marks li:nth-child(9) {
        transform: rotate(54deg) translateY(125px);
    }

    .marks li:nth-child(10) {
        transform: rotate(60deg) translateY(125px);
    }

    .marks li:nth-child(11) {
        transform: rotate(66deg) translateY(125px);
    }

    .marks li:nth-child(12) {
        transform: rotate(72deg) translateY(125px);
    }

    .marks li:nth-child(13) {
        transform: rotate(78deg) translateY(125px);
    }

    .marks li:nth-child(14) {
        transform: rotate(84deg) translateY(125px);
    }

    .marks li:nth-child(15) {
        transform: rotate(90deg) translateY(125px);
    }

    .marks li:nth-child(16) {
        transform: rotate(96deg) translateY(125px);
    }

    .marks li:nth-child(17) {
        transform: rotate(102deg) translateY(125px);
    }

    .marks li:nth-child(18) {
        transform: rotate(108deg) translateY(125px);
    }

    .marks li:nth-child(19) {
        transform: rotate(114deg) translateY(125px);
    }

    .marks li:nth-child(20) {
        transform: rotate(120deg) translateY(125px);
    }

    .marks li:nth-child(21) {
        transform: rotate(126deg) translateY(125px);
    }

    .marks li:nth-child(22) {
        transform: rotate(132deg) translateY(125px);
    }

    .marks li:nth-child(23) {
        transform: rotate(138deg) translateY(125px);
    }

    .marks li:nth-child(24) {
        transform: rotate(144deg) translateY(125px);
    }

    .marks li:nth-child(25) {
        transform: rotate(150deg) translateY(125px);
    }

    .marks li:nth-child(26) {
        transform: rotate(156deg) translateY(125px);
    }

    .marks li:nth-child(27) {
        transform: rotate(162deg) translateY(125px);
    }

    .marks li:nth-child(28) {
        transform: rotate(168deg) translateY(125px);
    }

    .marks li:nth-child(29) {
        transform: rotate(174deg) translateY(125px);
    }

    .marks li:nth-child(30) {
        transform: rotate(180deg) translateY(125px);
    }

    .marks li:nth-child(31) {
        transform: rotate(186deg) translateY(125px);
    }

    .marks li:nth-child(32) {
        transform: rotate(192deg) translateY(125px);
    }

    .marks li:nth-child(33) {
        transform: rotate(198deg) translateY(125px);
    }

    .marks li:nth-child(34) {
        transform: rotate(204deg) translateY(125px);
    }

    .marks li:nth-child(35) {
        transform: rotate(210deg) translateY(125px);
    }

    .marks li:nth-child(36) {
        transform: rotate(216deg) translateY(125px);
    }

    .marks li:nth-child(37) {
        transform: rotate(222deg) translateY(125px);
    }

    .marks li:nth-child(38) {
        transform: rotate(228deg) translateY(125px);
    }

    .marks li:nth-child(39) {
        transform: rotate(234deg) translateY(125px);
    }

    .marks li:nth-child(40) {
        transform: rotate(240deg) translateY(125px);
    }

    .marks li:nth-child(41) {
        transform: rotate(246deg) translateY(125px);
    }

    .marks li:nth-child(42) {
        transform: rotate(252deg) translateY(125px);
    }

    .marks li:nth-child(43) {
        transform: rotate(258deg) translateY(125px);
    }

    .marks li:nth-child(44) {
        transform: rotate(264deg) translateY(125px);
    }

    .marks li:nth-child(45) {
        transform: rotate(270deg) translateY(125px);
    }

    .marks li:nth-child(46) {
        transform: rotate(276deg) translateY(125px);
    }

    .marks li:nth-child(47) {
        transform: rotate(282deg) translateY(125px);
    }

    .marks li:nth-child(48) {
        transform: rotate(288deg) translateY(125px);
    }

    .marks li:nth-child(49) {
        transform: rotate(294deg) translateY(125px);
    }

    .marks li:nth-child(50) {
        transform: rotate(300deg) translateY(125px);
    }

    .marks li:nth-child(51) {
        transform: rotate(306deg) translateY(125px);
    }

    .marks li:nth-child(52) {
        transform: rotate(312deg) translateY(125px);
    }

    .marks li:nth-child(53) {
        transform: rotate(318deg) translateY(125px);
    }

    .marks li:nth-child(54) {
        transform: rotate(324deg) translateY(125px);
    }

    .marks li:nth-child(55) {
        transform: rotate(330deg) translateY(125px);
    }

    .marks li:nth-child(56) {
        transform: rotate(336deg) translateY(125px);
    }

    .marks li:nth-child(57) {
        transform: rotate(342deg) translateY(125px);
    }

    .marks li:nth-child(58) {
        transform: rotate(348deg) translateY(125px);
    }

    .marks li:nth-child(59) {
        transform: rotate(354deg) translateY(125px);
    }

    .marks li:nth-child(60) {
        transform: rotate(360deg) translateY(125px);
    }

    /* Particles / Unique Elements */
    .vline {
        width: 0;
        height: 200px;
        float: left;
        border-left: 1px solid rgba(2, 255, 255, 0.3);
    }

    .hline {
        width: 200px;
        height: 0;
        border-bottom: 1px solid rgba(2, 255, 255, 0.3);
    }

    #particle1 {
        position: fixed;
        margin-left: 260px;
        margin-top: 410px;
    }

    #particle1_1 {
        position: fixed;
        margin-left: 255px;
        margin-top: 480px;
    }

    #particle1_2 {
        position: fixed;
        margin-left: 275px;
        margin-top: 580px;
    }

    #particle1_3 {
        position: fixed;
        color: rgba(2, 255, 255, 0.3);
        font-size: 90px;
        margin-left: 190px;
        margin-top: 730px;
        transform: rotate(90deg);
        z-index: -1;
    }

    #particle2 {
        position: fixed;
        margin-left: 20px;
        margin-top: 20px;
    }

    #particle3 {
        position: fixed;
        height: 240px;
        margin-left: 40px;
    }

    #particle4 {
        position: fixed;
        height: 240px;
        margin-top: 200px;
        margin-left: -10px;
    }

    #particle5 {
        position: fixed;
        height: 290px;
        margin-top: -90px;
        margin-left: 230px;
        border-color: rgba(2, 255, 255, 0.15);
    }

    #particle6 {
        position: fixed;
        height: 290px;
        margin-top: 5px;
        margin-left: 3px;
        border-color: rgba(2, 255, 255, 0.2);
    }

    #particle7 {
        position: fixed;
        height: 290px;
        margin-top: 5px;
        margin-left: 3px;
        border-color: rgba(2, 255, 255, 0.15);
    }

    #particle8 {
        position: fixed;
        height: 500px;
        margin-left: -232px;
        margin-top: 280px;
        border-color: rgba(2, 255, 255, 0.15);
    }

    #particle9 {
        position: fixed;
        height: 320px;
        margin-left: 3px;
        border-color: rgba(2, 255, 255, 0.2);
    }

    /* Right Menu Particles */
    #particle10 {
        width: 330px;
        float: right;
        border-color: rgba(2, 255, 255, 0.5);
    }

    #particle11 {
        margin-right: 30px;
        margin-top: 3px;
        width: 330px;
        float: right;
        border-color: rgba(2, 255, 255, 0.5);
    }

    #particle12 {
        float: left;
        height: 352px;
        margin-top: -40px;
        border-color: rgba(2, 255, 255, 0.5);
    }

    #terminal {
        position: absolute;
        height: 2em;
        width: 30%;
        left: 0;
        right: 0;
        bottom: 5px;
        margin: 5px auto;
        color: #049372;
        font-family: 'Agency FB', sans-serif;
        font-size: 20px;
    }
    .arc_input {
        position: absolute;
        left: 0;
        right: 0;
        width: 250px;
        margin: 150px auto 10px auto;
        z-index: 2;
    }
    .arc_input_input {
        border: 0;
        position: relative;
        outline: none;
        background: transparent;
        color: #049372;
        font-size: 30px;
        text-align: center;
    }
</style>
{% endblock %}
{% block page %}
{% csrf_token %}
<div class="container-fluid full-page" id="cameraPopup">
    <div class="absolute-center text-center text-white" style="height:100px; width: 100%;">
        <i class="fas fa-camera fa-7x"></i> <br>
        <h2>Please grant access to camera to start!</h2>
    </div>
</div>
<div class="container-fluid full-page" id="cameraInitialisePopup">
    <div class="absolute-center text-center text-white" style="height:100px; width: 100%;">
        <i class="fas fa-camera fa-7x"></i> <br>
        <h2>Initialising...</h2>
    </div>
</div>
<div class="container-fluid full-page" id="main">
    <!-- Terminal -->
    <div id="terminal">
        <strong>></strong> <span class="terminal-text" id="terminalttx"></span>
    </div>
    <!-- Left Menu -->
    <div id="leftmenu">

        <div id="date_time">
            <div id="date" class="semi_arc e4">
                <div class="semi_arc_2 e4_1">
                    <div class="counterspin4"></div>
                </div>
                <div style="font-size: 40px; margin-top: 25px;" id="date_num">04</div>
                <div style="font-size: 25px;" id="month">January</div>
            </div>

            <div id="time" class="arc e1">
                <div style="font-size: 23px; margin-left: -10px; margin-top: 23px;" id="time_num">23:41</div>
                <div style="font-size: 15px; margin-left: 40px; margin-top: -30px; display; inline;" id="second">31</div>
                <div style="font-size: 17px; margin-top: 10px;" id="day">Tuesday</div>
            </div>
        </div>

        <p class="title">NAMASTE V1</p>
        <div class="hline title_underline"></div>

        <span class="menuitem entypo-gauge" style="font-size: 30px; margin-left: 10px;">
            <p id="cpu" class="caption" style="font-size: 20px;">Hello <span class="user_name">Sir</span></p>
        </span> <br />

        <span class="menuitem entypo-chart-area" style="font-size: 30px; margin-left: 10px;">
            <p id="ram" class="caption" style="font-size: 20px;">You seem <span class="current_mood">Detecting</span></p>
        </span> <br />

        <span class="menuitem entypo-chart-pie" style="font-size: 30px; margin-left: 10px;">
            <p id="proc" class="caption" style="font-size: 20px;">Some New Metric Here</p>
        </span>

        <p class="title">Explore</p>
        <div class="hline title_underline"></div>

        <div class="menu">
            <button class="menuitem"> <span class="entypo-right-open" />
                <p class="caption">News</p>
            </button>
            <button class="menuitem"> <span class="entypo-right-open" />
                <p class="caption">Music</p>
            </button>
            <button class="menuitem"> <span class="entypo-right-open" />
                <p class="caption">Social</p>
            </button>
            <button class="menuitem"> <span class="entypo-right-open" />
                <p class="caption">...</p>
            </button>

            <hr style="border-color: transparent; margin: 0;" />
            <div class="hline" style="margin-top: 5px; margin-bottom: 5px;"></div>

            <!-- <button class="menuitem"> <span class="entypo-right-open" />
                <p class="caption">Custom Path 1</p>
            </button>
            <button class="menuitem"> <span class="entypo-right-open" />
                <p class="caption">Custom Path 2</p>
            </button>
            <button class="menuitem"> <span class="entypo-right-open" />
                <p class="caption">Custom Path 3</p>
            </button> -->
        </div>

        <!-- <p class="title">Social</p>
        <div class="hline title_underline"></div>

        <div class="app_icon entypo-facebook-squared"></div>
        <div class="app_icon entypo-twitter"></div>
        <div class="app_icon entypo-gplus"></div>
        <div class="app_icon entypo-skype"></div>

        <div class="app_icon entypo-tumblr"></div>
        <div class="app_icon entypo-pinterest"></div>
        <div class="app_icon entypo-soundcloud"></div>
        <div class="app_icon entypo-stumbleupon"></div> -->

    </div>

    <!-- Right Menu -->
    <div id="rightmenu">
        <p class="title" style="text-align: left; margin-left: 10px;">My Feed</p>
        <div id="particle10" class="hline"></div>
        <div id="particle11" class="hline"></div>
        <div id="particle12" class="vline"></div>
        <textarea id="note_input" rows="12" cols="44">
            Loading your feed  
        </textarea>
    </div>

    <!-- Arc Reactor -->
    <div id="arc_container">
        <div class="arc_reactor">
            <div class="case_container">
                <div class="e7">
                    <div class="semi_arc_3 e5_1">
                        <div class="semi_arc_3 e5_2">
                            <div class="semi_arc_3 e5_3">
                                <div class="semi_arc_3 e5_4"></div>
                            </div>
                        </div>
                    </div>
                    <div class="core2"></div>
                </div>
                <ul class="marks">
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                    <li></li>
                </ul>
            </div>
        </div>
        <div class="arc_input">
            <input type="text" class="arc_input_input w-100" id="commandbox" placeholder="Let's talk!"/>
        </div>
    </div>

    <!-- Particles -->
    <!-- Left Menu Particles -->
    <canvas id="particle1" width="20" height="500"></canvas>
    <script>
        var canvas = document.getElementById('particle1');
        var context = canvas.getContext('2d');

        context.beginPath();
        context.moveTo(0, 0);
        context.lineTo(0, 70);
        context.lineTo(10, 85);
        context.lineTo(10, 135);
        context.lineTo(0, 150);
        context.lineTo(0, 480);
        context.lineTo(5, 490);
        context.lineTo(10, 490);
        context.lineTo(20, 490);
        context.lineTo(20, 250);
        context.lineTo(10, 235);
        context.lineTo(10, 185);
        context.lineTo(20, 170);
        context.lineTo(20, 40);
        context.lineTo(10, 30);
        context.lineTo(10, 20);

        context.closePath();
        context.lineWidth = 1;
        context.fillStyle = 'rgba(2,254,255,0.3)';
        context.fill();
        context.strokeStyle = 'transparent';
        context.stroke();
    </script>

    <canvas id="particle1_1" width="40" height="510"></canvas>
    <script>
        var canvas = document.getElementById('particle1_1');
        var context = canvas.getContext('2d');

        context.beginPath();
        context.lineTo(0, 0);
        context.lineTo(10, 15);
        context.lineTo(10, 65);
        context.lineTo(0, 80);
        context.lineTo(0, 0);

        context.closePath();
        context.lineWidth = 1;
        context.fillStyle = 'rgba(2,254,255,0.3)';
        context.fill();
        context.strokeStyle = 'transparent';
        context.stroke();
    </script>

    <canvas id="particle1_2" width="40" height="510"></canvas>
    <script>
        var canvas = document.getElementById('particle1_2');
        var context = canvas.getContext('2d');

        context.beginPath();
        context.lineTo(10, 80);
        context.lineTo(0, 65);
        context.lineTo(0, 15);
        context.lineTo(10, 0);
        context.lineTo(10, 80);

        context.closePath();
        context.lineWidth = 1;
        context.fillStyle = 'rgba(2,254,255,0.3)';
        context.fill();
        context.strokeStyle = 'transparent';
        context.stroke();
    </script>

    <div id="particle1_3">
        > > > >
    </div>

    <div id="particle2">▶<br />▶<br />▶</div>
    <div id="particle3" class="vline" />
    <div id="particle4" class="vline" />
    <div id="particle5" class="vline" />
    <div id="particle6" class="vline" />
    <div id="particle7" class="vline" />
    <div id="particle8" class="vline" />
    <div id="particle9" class="vline" />
</div>

    <canvas id="canvas" style="display: none;">
    </canvas>
    <div id="capturedFrames" style="display: none;">
    </div>
    <video id="video" class="display:none;">Camera Feed Initializing</video>
    <!-- <div class="container-fluid" id="faceDetector"> -->
<!-- <div class="alert alert-info" id="mainAlert"></div> -->
<!-- <div class="absolute-center">
            <div class="avatar mx-auto my-3">
                <img src="{% static 'portal/images/avatar.png' %}" id="avatar"/>
                <video id="video">Camera Feed Initializing</video>
            </div>
            <div class="alert alert-info" id="mainAlert"></div>
            <div class="progress" id="imageProgress">
                <div class="progress-bar" style="width:0%"></div>
            </div>
        </div>
    </div> -->
{% endblock %}
{% block footer_js %}
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.9"></script>
<script>
    /** CSRF Protection **/
    var csrf = $("[name=csrfmiddlewaretoken]").val();

    function csrfSafeMethod(method) {
        // these HTTP methods do not require CSRF protection
        return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }
    $.ajaxSetup({
        beforeSend: function (xhr, settings) {
            if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrf);
            }
        }
    });
    /** End CSRF Protection **/

    var imageSuccessCount = 0,
        imagePending = 0;
    var imageData = [];
    var avatar = $("#avatar");
    var status_text = $(".status_text");
    var canvas = document.getElementById("canvas");
    var video = document.getElementById("video");
    var alert = $("#mainAlert");
    var progress = $("#imageProgress");
    var vstream = null;
    var available_mood_classes = ["fa-smile-beam", "fa-frown-open", "fa-angry"];
    var terminal = $("#terminalttx");
    var user = null;

    function GetCameraPermissions() {
        if (!navigator.mediaDevices) {
            alert("MediaDevices API is not supported on your browser! Exiting!");
            return;
        }
        if(!navigator.mediaDevices.enumerateDevices)
            $("#cameraPopup").show();
        return navigator.mediaDevices.getUserMedia({
            video: true,
            // audio: true
        }).then(cameraInitialized);
    }

    function resetCaptureFrames() {
        imageSuccessCount = 0;
        imagePending = 0;
        imageData = [];
    }

    function cameraInitialized(stream) {
        $("#cameraPopup").fadeOut();
        video.srcObject = stream;
        vstream = stream;
        video.play();
        avatar.fadeOut();
        $("#video").fadeIn();
    }

    function startCapturingFrames(callback) {
        
        console.log("Starting");
        $("#faceDetector").fadeIn();
        var frame = captureFrame();
        callback(frame);
    }

    function captureFrame(){
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        var context = canvas.getContext('2d');
        context.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);
        var data = canvas.toDataURL();
        return data;
    }

    function stopCapturingFrames() {
        vstream.getTracks()[0].stop();
    }

    function startMoodDetection(frame) {
        logTerminal("Preparing Mood Detection Engine...");
        stopCapturingFrames();
        let payload = prepareImagePayload(frame);
        // logTerminal("Preparing Payload for server...Connecting to server...");
        $(".current_mood").html($(".current_mood").html() + ' <i class="fas fa-spin fa-circle-notch"></i>');
        $.ajax({
            url: "{% url 'api:detect-mood' %}",
            data: payload,
            type: 'POST',
            success: function (response) {
                if (response.status){
                    moodData = response.mood;
                    loadMoodData();
                }else{
                    $(".current_mood").html("Error!");
                }
            }
        });
    }

    function loadMusic(emotion) {}

    function getB64Data(data) {
        // return data;
        return data.split(",")[1];
    }

    function prepareImagePayload(data) {
        var b64Image = getB64Data(data);
        var postData = {
            "image": b64Image
        };
        console.log(postData)
        return postData;
    }

    function setClock(){
        let days = ["Mon", "Tues", "Wed", "Thurs", "Fri", "Sat", "Sun"];
        let months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "December"];
        setInterval(function(e){
            var curr = new Date();
            $("#date_num").html(curr.getDate());
            $("#time_num").html(curr.getHours() + ":" + curr.getMinutes());
            $("#day").html(days[curr.getDay() - 1]);
            $("#month").html(months[curr.getMonth()]);
            $("#second").html(curr.getSeconds());
        }, 1000);
    }

    function loadUser(){
        if(user != null)
            return
        $.ajax({
            url: "{%  url 'api:get-logged-in-user' %}",
            method: 'GET',
            dataType: 'JSON',
            success: function(response){
                if(response.status){
                    user = response.data;
                    loadUserData();
                }else{
                    window.location.reload();
                }
            }
        })
    }

    function loadUserData(){
        if(user == null)
            return

        logTerminal("Initialising user data, Hello " + user.name);

        $(".user_name").html(user.name);
    }

    function loadMoodData(){
        if(moodData == null)
            return
        $(".current_mood").html(moodData);
        logTerminal("You seem to be " + moodData + "...");
        setTimeout(function(){
            GetCameraPermissions();
            $(video).one('canplay', function () {
                startCapturingFrames(startMoodDetection);
            });
        }, 60000);
    }

    var terminal_queue = ["Initialising", ];
    var typed = null;
    var terminal_empty = true;
    function logTerminal(msg){
        terminal_queue.push(msg);
    }
    function loadNextForTerminal(){
        console.log("Poll");
        console.log(terminal_queue);
        console.log(terminal_empty);
        if(!terminal_empty) return;
        if(terminal_queue.length == 0) return;
        // if(typed) typed.destroy();
        terminal_empty = false;
        terminal.fadeIn();
        typed = new Typed(terminal[0], {
            strings: ["", terminal_queue.shift()],
            typeSpeed: 5,
            loop: false,
            loopCount: 1,
            contentType: 'html',
            backDelay: 200,
            onStart: function(self){
                // terminal.fadeIn();
                terminal_empty = false;
            },
            onComplete: function(self){
                setTimeout(function(){
                    terminal.fadeOut();
                    setTimeout(function(){
                        typed.destroy();
                        terminal_empty = true;
                    }, 500); 
                }, 500);
            },
            onDestroy: function(self){
                // terminal_empty = true;
            }
        });
    }

    function init() {
        $("#cameraInitialisePopup").show();
        setInterval(function(){
            loadNextForTerminal();
        }, 1000);
        
        setClock();
        loadUser();
        GetCameraPermissions();
        $("#cameraInitialisePopup").fadeOut();
        $(video).one('canplay', function () {
            // logTerminal("Starting Mood Detection...");
            startCapturingFrames(startMoodDetection);
        });
    }

    init();
</script>
{% endblock %}